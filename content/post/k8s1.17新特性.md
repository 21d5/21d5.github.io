---
title: Kubernetes 1.17 有什么新特性？
date: 2019-12-07
tags: ["kubernetes", "ingress", "traefik", "nginx", "haproxy", "kong"]
keywords: ["kubernetes", "ingress", "traefik", "nginx", "haproxy", "kong"]
slug: what-is-new-in-k8s-1.17
gitcomment: true
bigimg: [{src: "/img/posts/photo-1534181220741-388dc50c711d.jpg", desc: "In the middle of the nowhere"}]
category: "kubernetes"
draft: true
---
Kubernetes 1.17 即将发布！这个 release 主要集中在一些小的改进和优化上面，也有一些比较有用的新特性，比如前面我们已经介绍过的**拓扑感知路由**，以及对 IPv4/IPv6 双堆栈支持的改进。下面我们来看下此次发布版本有哪些新特性。

### 编辑精选
下面这些新特性可能是一些非常有用的功能：

* #536 Services 的拓扑感知路由
* #1053 kubeadm machine/结构化 输出
* #1152 避免为每个观察者单独序列化同一个对象
* #563 添加 IPv4/IPv6 双堆栈支持

### 核心功能

[#1053](https://github.com/kubernetes/enhancements/issues/1053) Kubeadm `machine/结构化` 输出
阶段：Alpha
功能组：cluster-lifecycle（集群生命周期）

部署 kubernetes 集群最常见的方法是通过自动化工具，比如 kubeadm 或者依赖它的工具，比如 terraform。kubeadm 的当前输出不是结构化的，因此对 kubeadm 的一个小的更改可能会破坏与其集成的其他工具。

这个 alpha 特性允许以机器可读的结构化格式（如 json、yaml 或 go template）从 kubeadm 获取输出内容。类似于如下所示的命令：
```shell
$ kubeadm token list
TOKEN                     TTL         EXPIRES                     USAGES                   DESCRIPTION                                                EXTRA GROUPS
7vg8cr.pks5g06s84aisb27   <invalid>   2019-06-05T17:13:55+03:00   authentication,signing   The default bootstrap token generated by 'kubeadm init'.   system:bootstrappers:kubeadm:default-node-token
```

这个时候我们可以使用 `-o` 或者 `-experimental-output` 参数，输出结构化的数据：
```shell
$ kubeadm token list -o json
{
    "kind": "BootstrapToken",
    "apiVersion": "output.kubeadm.k8s.io/v1alpha1",
    "creationTimestamp": null,
    "token": "7vg8cr.pks5g06s84aisb27",
    "description": "The default bootstrap token generated by 'kubeadm init'.",
    "expires": "2019-06-05T14:13:55Z",
    "usages": [
        "authentication",
        "signing"
    ],
    "groups": [
        "system:bootstrappers:kubeadm:default-node-token"
    ]
}
```

我们可以在 [PR](https://github.com/kubernetes/kubernetes/pull/78764) 和 [KEP](https://github.com/kubernetes/enhancements/blob/master/keps/sig-cluster-lifecycle/kubeadm/20190506-kubeadm-machine-output.md) 页面中查看改功能的一些示例。

[#1143](https://github.com/kubernetes/enhancements/issues/1143) 明确在 Kubernetes 中使用 node-role 标签并迁移旧组件
阶段：Alpha
功能组：architecture（架构）

